@{
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
    ViewBag.Menu2 = Poco.SystemConst.Menu.PropertyFeeInfo;
    ViewBag.Menu3 = Poco.SystemConst.Menu.PropertyFeeInfo;
}
@section head{
    <script src="@Url.Content("~/Scripts/timepicker/jquery-ui-timepicker-addon.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/timepicker/jquery-ui-timepicker-zh-CN.js")" type="text/javascript"></script>
    <script src="@Url.Content("~/Scripts/timepicker/jquery.ui.datepicker-zh-CN.js.js")" type="text/javascript"></script>
    <script>
        $(function () {
            //            $("label[name=labCbFirst]").each(function () {
            //                $(this).tipTip({ activation: "hover", delay: 3, defaultPosition: "bottom" });
            //            });
            $("#Date").val('@ViewBag.Date');
            $("#Unit").val('@ViewBag.Unit');
            $("#RoomNumber").val('@ViewBag.RoomNumber');
            $("#OwnerName").val('@ViewBag.OwnerName');
            $("#OwnerPhone").val('@ViewBag.OwnerPhone');

            $("#Date").datepicker({
                changeMonth: true,
                changeYear: true,
                dateFormat: 'yy-mm'
            });

            //导入状态 1出错 2成功
            var IsErro = '@ViewBag.IsError';
            var ErrorStr = '@ViewBag.ErrorStr';
            if (IsErro == 1) {
                JAlert({
                    Message: ErrorStr,
                    DialogType: "Ok",
                    BtnOk: "确定"
                });
            }
            else if (IsErro == 2) {
                JAlert({
                    Message: "导入成功！",
                    DialogType: "Ok",
                    BtnOk: "确定"
                    //                    BtnOkClick: "location.reload()" ,
                    //                    BtnCancelClick: "$(this).dialog('close');"
                });
            }
        });


        //导入窗体
        function Showimport() {
            $("#dialogimport").dialog({
                resizable: false,
                height: 200,
                width: 450,
                modal: true,
                draggable: false,
                close: function (event, ui) {

                }
            });
        }

        function CheckImport() {
            var ImExcel = $("#ImExcel").val();
            if (ImExcel != null && ImExcel != undefined) {
                if (ImExcel.length <= 0) {
                    JMessage("请选择文件", true)
                    return false;
                }
                else {

                }
            }
        }
    </script>
    <style>
        .main
        {
            width: 1200px !important;
        }
    </style>
}
@model PagedList<Poco.PropertyFeeInfo>
<div class="title" style="width: 988px">
    <div style="float: right">
        <a href="/Download/Property/物业费导入模板.xlsx" target="_blank" style=" color:#00aec8">下载物业费导入模板</a></div>
    @Html.Partial("Menu3")
    <div style="clear: both">
    </div>
</div>
<div class="body" style="width: 988px">
    @using (Html.BeginForm("Index", "PropertyFeeInfo", new { HostName = ViewBag.HostName }, FormMethod.Get, new { enctype = "multipart/form-data" }))
    {
        <table style="width: 800px">
            <tr>
                <td>
                    缴费日期：
                </td>
                <td>
                    <input type="text" id="Date" name="Date" />
                </td>
                <td>
                    单元：
                </td>
                <td>
                    <input type="text" id="Unit" name="Unit" />
                </td>
                <td>
                    房号:
                </td>
                <td>
                    <input type="text" id="RoomNumber" name="RoomNumber" />
                </td>
            </tr>
            <tr>
                <td>
                    业主姓名：
                </td>
                <td>
                    <input type="text" id="OwnerName" name="OwnerName" />
                </td>
                <td>
                    业主电话：
                </td>
                <td>
                    <input type="text" id="OwnerPhone" name="OwnerPhone" />
                </td>
                <td>
                </td>
                <td>
                    <input type="submit" id="btnSubmit" value="查询" class="button" style="" />
                    <input type="button" id="btnImport" value="导入" onclick="Showimport()" class="button"
                        style="margin-left: 20px" />
                </td>
            </tr>
        </table>
    }
    <div class="pages" style="margin-bottom: 5px; margin-top: 10px;">
        @Html.Pager(Model, new PagerOptions
   {
       PageIndexParameterName = "ID",
       CurrentPagerItemWrapperFormatString = "<span class=\"pagenum_selected\"><a>{0}</a></span>",
       NumericPagerItemWrapperFormatString = "<span class=\"pagenum\">{0}</span>",
       NavigationPagerItemWrapperFormatString = "<span class=\"pagenum\">{0}</span>",
       CssClass = "manage_pages pages",
       SeparatorHtml = "&nbsp;",
       AutoHide = false,
       /*LastPageText = "Last",
       FirstPageText = "First",
       PrevPageText = "Back",
       NextPageText = "Next",*/
       PageIndexOutOfRangeErrorMessage = "Page index out of range.",
       ShowFirstLast = false
   })
    </div>
    <table class="tableList" cellpadding="0" cellspacing="0" style="font-size: 14px">
        <tr>
            <th>
                业主姓名
            </th>
            <th>
                业主电话
            </th>
            <th>
                单元
            </th>
            <th>
                房号
            </th>
            <th>
                缴费月份
            </th>
            <th>
                物业管理费
            </th>
            <th>
                物业服务费
            </th>
            <th>
                固定停车费
            </th>
            <th>
                电梯费
            </th>
            <th>
                水费
            </th>
            <th>
                卫生费
            </th>
            <th>
                其他费用
            </th>
            <th>
                合计
            </th>
            <th style="width: 200px">
                备注
            </th>
        </tr>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @item.OwnerName
                </td>
                <td>
                    @item.OwnerPhone
                </td>
                <td>
                    @item.Unit
                </td>
                <td>
                    @item.RoomNumber
                </td>
                <td>
                    @item.PayDate
                </td>
                <td>
                    @item.ManagerFee
                </td>
                <td>
                    @item.ServiceFee
                </td>
                <td>
                    @item.ParkingFee
                </td>
                <td>
                    @item.ElevatorFee
                </td>
                <td>
                    @item.WaterFee
                </td>
                <td>
                    @item.HealthFee
                </td>
                <td>
                    @item.OrterFee
                </td>
                <td>
                    @item.Total
                </td>
                <td>
                    <div style="width: 195px; word-break: keep-all;">
                        @item.Remarks
                    </div>
                </td>
            </tr>
        }
    </table>
    <div class="pages" style="margin-bottom: 5px; margin-top: 10px;">
        @Html.Pager(Model, new PagerOptions
       {
           PageIndexParameterName = "ID",
           CurrentPagerItemWrapperFormatString = "<span class=\"pagenum_selected\"><a>{0}</a></span>",
           NumericPagerItemWrapperFormatString = "<span class=\"pagenum\">{0}</span>",
           NavigationPagerItemWrapperFormatString = "<span class=\"pagenum\">{0}</span>",
           CssClass = "manage_pages pages",
           SeparatorHtml = "&nbsp;",
           AutoHide = false,
           /*LastPageText = "Last",
           FirstPageText = "First",
           PrevPageText = "Back",
           NextPageText = "Next",*/
           PageIndexOutOfRangeErrorMessage = "Page index out of range.",
           ShowFirstLast = false
       })
    </div>
</div>
<div id="dialogimport" title="报名列表" style="display: none; padding: 0px">
    @using (Html.BeginForm("ImportExcel", "PropertyFeeInfo", new { HostName = ViewBag.HostName, id = ViewBag.pageid }, FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <table width="100%" style="margin-top: 30px">
            <tr>
                <td width="120px">
                    请选择Excel文件：
                </td>
                <td>
                    <input type="file" id="ImExcel" name="ImExcel" />
                </td>
            </tr>
            <tr>
                <td>
                </td>
                <td>
                    <input type="submit" id="btnImportSubmit" onclick="return CheckImport()" value="导入"
                        class="button" style="" />
                </td>
            </tr>
        </table>
    }
</div>
