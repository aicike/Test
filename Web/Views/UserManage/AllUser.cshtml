@{
    Layout = "~/Views/Shared/_LayoutUser.cshtml";

    ViewBag.Menu2 = Poco.SystemConst.Menu.UserManage;
    ViewBag.Menu3 = Poco.SystemConst.Menu.UserManage;
}
@section head{
}
@model PagedList<Poco.User>
<div class="title">
    @Html.Partial("Menu3")
</div>
<div class="body">

    <div class="option">
        @using (Html.BeginForm("AllUser", "UserManage", new { HostName = ViewBag.HostName }, FormMethod.Get))
        {
            <table style="width: 100%">
                <tr>
                    <td>
                        楼号缩写：
                        <input type="text" id="houseShortNum" name="houseShortNum" />
                    </td>
                    <td>
                        业主姓名：
                        <input type="text" id="houseName" name="houseName" />
                    </td>
                    <td>
                        业主电话：
                        <input type="text" id="housePhone" name="housePhone" />
                    </td>
                    <td style="text-align: right">
                        <input type="submit" id="btnSubmit" value="查询" class="button" style="" />
                    </td>
                </tr>
            </table>
        }
    </div>
    <table class="tableList" cellpadding="0" cellspacing="0">
        <tr>
            <th style="width: 120px;">
                业主姓名
            </th>
            <th style="width: 200px;">
                业主电话
            </th>
            <th style="width: 50px;">
                楼号
            </th>            
            <th style="width: 50px;">
                单元
            </th>            
            <th style="width: 50px;">
                房号
            </th>
            <th style="width: 100px;">
                操作
            </th>
        </tr>
        @foreach (var item in Model)
        {
            var pu = item.UserLoginInfo.Property_Users.Where(a => a.UserLoginInfoID == item.UserLoginInfoID).FirstOrDefault();
            if (pu == null) {
                continue;
            }
            <tr>
                <td class="operation">
                 <a  href="@Url.Action("Index", "SingleChat", new { HostName = ViewBag.HostName, id = 1, userID = item.ID })" target="_blank">

                    @item.UserLoginInfo.Name
                     </a>
                </td>
                <td class="operation">
                    @item.Phone
                </td>
                <td>
                    @(pu==null?"":pu.Property_House.BuildingNum)
                </td>
                <td>
                    @(pu==null?"":pu.Property_House.CellNum)
                </td>
                <td>
                    @(pu==null?"":pu.Property_House.RoomNumber)
                </td>
                <td class="operation">
                    @Html.ActionLink("详细", "ViewUser", "UserManage", new { userID = item.ID }, null)
                    <br />
                    <label name="labCbFirst" title="该用户与之前的销售代表聊天记录">
                        <a href="@Url.Action("HistoryMes", "SingleChat", new { userID = item.ID })" style=" margin-left:-5px" target="_blank" title="">
                            聊天历史</a>
                    </label>
                </td>
            </tr>
        }
    </table>
</div>
